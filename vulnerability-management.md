

# AWS Vulnerability Management Services Deep Dive

---

## 1. **Amazon Inspector**  
**Description**:  
Automated vulnerability and network exposure scanner for **EC2 instances**, **ECR container images**, and **Lambda functions**.  

### Key Features:  
- **Scan Types**:  
  - **Network Reachability**: Open ports, CVSS scores for vulnerabilities.  
  - **Host Assessment**: CIS benchmarks, SSH/RDP hardening checks.  
  - **Lambda Code Scans**: Dependency vulnerabilities (e.g., Log4j).  
- **Integration**: Findings sent to AWS Security Hub and EventBridge.  
- **Continuous Scanning**: Auto-triggered when new resources are deployed.  

**Use Cases**:  
- Identify unpatched CVEs in Docker images (e.g., CVE-2023-1234).  
- Detect EC2 instances with public SSH/RDP access (0.0.0.0/0).  

**Key Permissions**:  
```plaintext
inspector2:ListFindings          # Retrieve vulnerability reports  
inspector2:CreateFilter          # Customize findings (e.g., filter by severity)  
```

**Exam Tips**:  
- **Inspector vs. GuardDuty**:  
  - Inspector focuses on **vulnerabilities** (CVE/CIS).  
  - GuardDuty focuses on **threats** (malicious activity).  
- Use **EventBridge** to trigger Lambda for auto-remediation (e.g., quarantine instances).  

---

## 2. **AWS Systems Manager (SSM) Patch Manager**  
**Description**:  
Automates patching for EC2 instances, on-prem servers, and edge devices.  

### Key Features:  
- **Predefined Patch Baselines**: Critical/security updates for OS (Windows, Linux).  
- **Maintenance Windows**: Schedule patching during off-peak hours.  
- **Compliance Reporting**: Track patch status across resources.  

**Use Cases**:  
- Enforce patching SLAs (e.g., critical patches applied within 72 hours).  
- Remediate vulnerabilities identified by Inspector.  

**Key Permissions**:  
```plaintext
ssm:CreateMaintenanceWindow     # Define patching schedules  
ssm:SendCommand                 # Execute patch commands  
```

**Exam Tips**:  
- Use **Patch Groups** to apply different baselines (e.g., "Prod" vs. "Dev").  
- **SSM Agent** must be installed on target instances.  

---

## 3. **AWS Security Hub**  
**Description**:  
Centralized view of security findings, including vulnerability data from Inspector, third-party tools, and AWS Foundational Security Best Practices.  

### Key Features:  
- **AWS Foundational Standards**: 100+ automated compliance checks (e.g., "S3 buckets should have encryption enabled").  
- **Automated Security Findings Format (ASFF)**: Normalized JSON schema for cross-service findings.  

**Use Cases**:  
- Aggregate Inspector findings with GuardDuty/Macie alerts.  
- Generate vulnerability compliance reports (e.g., PCI DSS).  

**Key Permissions**:  
```plaintext
securityhub:BatchImportFindings  # Integrate custom tools  
securityhub:UpdateFindings       # Mark vulnerabilities as resolved  
```

**Exam Tips**:  
- Enable **Consolidated Controls** to map findings to compliance frameworks (e.g., NIST 800-53).  

---

## 4. **AWS Config**  
**Description**:  
Tracks resource configurations and compliance with predefined/custom rules.  

### Key Features:  
- **Managed Rules**: Prebuilt checks (e.g., `restricted-ssh`, `s3-bucket-public-write-prohibited`).  
- **Remediation**: Auto-fix non-compliant resources (e.g., enable S3 bucket encryption).  

**Use Cases**:  
- Detect security groups allowing unrestricted inbound access.  
- Enforce EBS volume encryption.  

**Key Permissions**:  
```plaintext
config:PutRemediationConfigurations  # Define auto-fix actions  
config:DescribeComplianceByConfigRule # Check compliance status  
```

**Exam Tips**:  
- Use **Conformance Packs** to deploy sets of rules (e.g., GDPR, HIPAA).  

---

## 5. **Amazon EC2 Image Builder**  
**Description**:  
Creates secure, patched AMIs and container images with predefined pipelines.  

### Key Features:  
- **Golden Image Pipelines**: Automate OS updates and vulnerability scanning.  
- **Integration**: Inspector scans images before deployment.  

**Use Cases**:  
- Ensure base AMIs are hardened and free of known CVEs.  
- Streamline compliance for immutable infrastructure.  

**Key Permissions**:  
```plaintext
imagebuilder:CreateImagePipeline  # Define build/test/distribute workflows  
imagebuilder:StartImagePipelineExecution # Trigger pipeline runs  
```

**Exam Tips**:  
- Combine with **Inspector** for pre-deployment vulnerability checks.  

---

## 6. **AWS Marketplace (Third-Party Tools)**  
**Description**:  
Hosts vulnerability management solutions like Qualys, Tenable, and Rapid7.  

### Key Features:  
- **Preconfigured AMIs/SCANS**: Deploy enterprise-grade vulnerability scanners.  
- **Integration**: Forward findings to Security Hub.  

**Use Cases**:  
- Hybrid environment scanning (AWS + on-prem).  
- Advanced compliance reporting (e.g., FedRAMP).  

**Key Permissions**:  
```plaintext
ec2:RunInstances  # Launch Marketplace AMIs  
```

**Exam Tips**:  
- Use **License Manager** to track third-party tool licenses.  

---

## 7. **AWS Trusted Advisor**  
**Description**:  
Provides real-time guidance to optimize AWS infrastructure, including security checks.  

### Key Features:  
- **Security Category**: Highlights open ports, IAM misconfigurations, and MFA usage.  
- **Cost Optimization**: Identifies underutilized resources.  

**Use Cases**:  
- Detect publicly accessible RDS instances.  
- Identify root accounts without MFA.  

**Access**:  
- Free checks for all users; **Business/Enterprise Support** for full access.  

**Exam Tips**:  
- **Trusted Advisor vs. Inspector**:  
  - Trusted Advisor checks **configuration** issues.  
  - Inspector detects **software vulnerabilities**.  

---

## Comparison Table: Vulnerability Management Services

| Service                | Scope                      | Key Functionality                  | Integration               |  
|------------------------|----------------------------|------------------------------------|---------------------------|  
| **Amazon Inspector**   | EC2/ECR/Lambda             | CVE/CIS scanning                   | Security Hub/EventBridge  |  
| **SSM Patch Manager**  | EC2/On-prem                | OS patching automation             | Maintenance Windows       |  
| **AWS Config**         | Multi-service              | Resource compliance checks         | Conformance Packs         |  
| **EC2 Image Builder**  | AMI/Containers             | Pre-hardened image creation        | Inspector                 |  
| **Security Hub**       | Cross-service              | Findings aggregation & reporting   | Inspector/Third-party     |  

---

## Exam Scenarios:  
1. **Zero-Day Vulnerability Response**:  
   - Inspector detects a critical CVE in ECR images.  
   - EventBridge triggers Lambda to stop affected tasks.  
   - SSM Patch Manager updates base AMIs via Image Builder.  

2. **Compliance Reporting**:  
   - Security Hub aggregates Inspector findings and Config compliance checks.  
   - Audit Manager generates evidence for PCI DSS Requirement 6.2.  

3. **Hybrid Environment Patching**:  
   - Use SSM Patch Manager to update on-prem servers.  
   - Forward third-party vulnerability data to Security Hub.  

---

## Critical IAM Permissions:  
- **Inspector**: `inspector2:ListFindings` (required for Security Hub integration).  
- **SSM**: `ssm:GetParameter` (to retrieve patching schedules).  
- **Security Hub**: `securityhub:BatchImportFindings` (for third-party tool integration).  

---

## Key Concepts:  
- **CVE (Common Vulnerabilities and Exposures)**: Publicly disclosed security flaws.  
- **CVSS (Common Vulnerability Scoring System)**: Severity scoring (0-10).  
- **CIS Benchmarks**: Configuration best practices for secure systems.  


---